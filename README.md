# CelryFlaskTemplate
шаблонный (тестовый) проект с Celery, Flower, Flask

### Идея

Сделать заготовку, из которой можно будет взять фрагменты и собрать нужное решение.

Используются
* Celery
* Redis
* Flower
* Flask
* Docker-compose

Запускаетя всё командой
``` 
docker-compose up --detach
````

При этом:
* Запускается контейнер с Redis
* Запускается контейнер с Worker'ом - он делает одну задачу (засыпает на заданное время).
* Запускается контейнер с Flower
* Запускается контейнер c Flask

На самом деле контейнеры с Worker, Flower и Flask это один и тот же контейнер.
Только в них запускаются разные приложения.

### Использование
Можно послать такой запрос http://localhost:8080/main/test
```json
{
    "delay": 28,
    "s_param": "auto"
}
```

Приложение Flask примет этот запрос и отправит запрос через API Flower.
В этом запросе к API Flower отправляется задача 'queue_1:task_type_1'.

Worker смотрит за очередью queue_1.

Задача task_type_1, которую выполняет Worker определена в функции
run_task_1 - delay на заданное количество секунд.

Результаты выполненных тасков можно посмотреть на дашборде
Flower http://localhost:15555.


